var shader = document.getElementById("fragmentShaderOctree").textContent

module.exports = function(maxIterations) {
  shader = shader.replace("#ITERATIONS_CONST", "const int iterations = " + maxIterations + ";")

  for(var i = 0; i<8; i++) {
    var generatedLoop = ''
    for(j = 1; j<maxIterations; j++) {
      generatedLoop += 'if(pushIdx == ' + j + ') queue[' + j + '] = texture2D(textureOctree, nodeIndices[' + (i + 2) + ']).x;'
    }

    shader = shader.replace("#CHILD_" + (i + 2), generatedLoop)
  }

  return shader
}